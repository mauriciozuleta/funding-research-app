{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="d-flex" style="height: calc(90vh - 56px);">
  <!-- VSCode-style Sidebar -->
  <div id="sidebarContainer" class="d-flex" style="height: 100%;">
    <!-- Vertical icon-only bar -->
    <div id="sidebarIcons" class="d-flex flex-column align-items-center py-3" style="width: 56px; min-width: 56px; border-right: 1px solid #23272f; height: 100%; background: #181a20;">
      <img src="https://img.icons8.com/ios/50/ff6f61/microscope--v1.png" alt="Research" id="fundingSidebarIcon" class="sidebar-icon active" style="width:32px; height:32px; margin-bottom: 16px; cursor:pointer;" title="Research">
      <img src="https://img.icons8.com/ios/50/43d675/folder-invoices--v1.png" alt="Folder" id="folderSidebarIcon" class="sidebar-icon" style="width:32px; height:32px; margin-bottom: 16px; cursor:pointer;" title="Folder">
      <img src="https://img.icons8.com/ios/50/f9a825/name--v1.png" alt="User Banner" id="userBannerSidebarIcon" class="sidebar-icon" style="width:32px; height:32px; margin-bottom: 16px; cursor:pointer;" title="Personal Banner">
      <img src="https://img.icons8.com/ios/50/8e44ad/robot--v1.png" alt="AI Agent" id="openAISidebarIcon" class="sidebar-icon" style="width:32px; height:32px; margin-bottom: 16px; cursor:pointer; background:none; border-radius:6px; padding:2px;" title="AI Agent Chat">
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/openai.svg" alt="OpenAI Subscription" id="openAISubscriptionSidebarIcon" class="sidebar-icon" style="width:32px; height:32px; margin-bottom: 16px; cursor:pointer; background:none; border-radius:6px; padding:2px;" title="Manage OpenAI Subscription">
      <div style="flex-grow:1;"></div>
      <img src="https://img.icons8.com/ios/50/4f8cff/settings.png" alt="Settings" id="settingsSidebarIcon" class="sidebar-icon" style="width:32px; height:32px; margin-bottom: 0; cursor:pointer;" title="Settings">
    </div>
    <!-- Sidebar options, toggled by icon click -->
    <nav id="sidebar" class="bg-dark text-light p-3" style="width: 0; min-width: 0; max-width: 220px; overflow: hidden; display: flex; flex-direction: column; align-items: stretch; border-right: 1px solid #23272f; transition: width 0.2s, min-width 0.2s, padding 0.2s; padding: 0;">
      <div id="sidebarOptions" style="display: none;">
        <!-- Funding Research options -->
        <div id="fundingOptions" style="color: #ff6f61;">
          <div class="mb-2" style="font-weight: bold;">Funding Research</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">Fund new research</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">My applications</div>
        </div>
        <!-- Folder options -->
        <div id="folderOptions" style="color: #43d675; display:none;">
          <div class="mb-2" style="font-weight: bold;">Folders</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">My Documents</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">Shared Folders</div>
        </div>
        <!-- User Banner options -->
        <div id="userBannerOptions" style="color: #f9a825; display:none;">
          <div class="mb-2" style="font-weight: bold;">Personal Banner</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">Profile</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">Settings</div>
        </div>
        <!-- OpenAI options (chat) -->
        <div id="openAIOptions" style="color: #8e44ad; display:none;">
          <div class="mb-2" style="font-weight: bold;">OpenAI Chat</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">Ask Anything</div>
        </div>
        <!-- OpenAI Subscription options -->
        <div id="openAISubscriptionOptions" style="color: #00a67e; display:none;">
          <div class="mb-2" style="font-weight: bold;">OpenAI Subscription</div>
          <div class="mt-2" id="manageSubscriptionBtn" style="cursor:pointer; font-weight: normal;">Manage Subscription</div>
          <div class="mt-2" style="cursor:pointer; font-weight: normal;">Credit Status</div>
        </div>
        <!-- Add more options sections here for other icons -->
      </div>
    </nav>
  </div>
  <!-- Main Content -->
  <div class="flex-grow-1 d-flex flex-column" id="mainContent" style="background:#181a20; transition: margin-left 0.2s;">
    <!-- Dashboard Title -->
    <div class="px-4 pt-4">
      <h2 id="dashboardTitle" class="fw-bold text-light mb-2" style="letter-spacing:0.5px;">
        {% if user.first_name or user.last_name %}
          {{ user.first_name }} {{ user.last_name }} Dashboard
        {% else %}
          {{ user.username }} Dashboard
        {% endif %}
      </h2>
      <hr style="border: none; border-top: 2px solid #343a40; margin: 0 0 24px 0; width: 100%;">
    </div>
    <!-- Dashboard Workspace -->
    <div class="flex-grow-1 d-flex flex-column" id="dashboardWorkspace" style="min-height:400px;">
      
    </div>
  </div>
</div>


<!-- Minimal Amelia Chatbox (Outlined, single row, paper plane icon) -->
<div id="ameliaChatbox" style="position: sticky; bottom: 0; left: 0; right: 0; margin: 0 auto; z-index: 1050; width: 100%; max-width: 520px; min-width: 260px; border: 2px solid #8e44ad; border-radius: 32px; background: transparent; box-shadow: none; padding: 0; display: flex; align-items: center; justify-content: center; height: 56px;">
  <form id="ameliaChatForm" autocomplete="off" style="display: flex; align-items: center; gap: 8px; width: 100%; padding: 0 12px;">
    <img src="https://img.icons8.com/ios/32/8e44ad/robot-2--v2.png" alt="Amelia" style="width:28px; height:28px; margin-right:6px; background:transparent;">
    <input type="text" class="form-control" id="ameliaChatInput" placeholder="Message Amelia..." style="background: transparent; color: #b0aecd; border: none; border-bottom: 1.5px solid #8e44ad; border-radius: 0; padding: 0 8px; height: 36px; font-size: 1rem; box-shadow: none; outline: none;">
    <button type="submit" style="background: transparent; border: none; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; padding: 0;">
      <img src="https://img.icons8.com/ios/28/8e44ad/paper-plane--v1.png" alt="Send" style="width:24px; height:24px; filter: none;">
    </button>
  </form>
</div>
<script>
// Minimal Amelia chatbox mockup
const ameliaForm = document.getElementById('ameliaChatForm');
const ameliaInput = document.getElementById('ameliaChatInput');
if (ameliaForm) {
  ameliaForm.onsubmit = function(e) {
    e.preventDefault();
    const msg = ameliaInput.value;
    if(msg.trim()) {
      alert('Amelia: ' + msg);
      ameliaInput.value = '';
    }
  };
}
</script>

{% endblock %}
